import { MetorialSDK, MetorialCoreSDK } from '@metorial/core';
import { RequestOptions } from '@modelcontextprotocol/sdk/shared/protocol.js';
import { ClientCapabilities, CompleteRequest, CompleteResult, LoggingLevel, GetPromptRequest, GetPromptResult, ListPromptsRequest, ListPromptsResult, ListResourcesRequest, ListResourcesResult, ListResourceTemplatesRequest, ListResourceTemplatesResult, ReadResourceRequest, ReadResourceResult, CallToolRequest, CallToolResultSchema, CompatibilityCallToolResultSchema, ListToolsRequest, ListToolsResult } from '@modelcontextprotocol/sdk/types.js';
import { DashboardInstanceSessionsCreateBody } from '@metorial/generated';
import * as _metorial_json_schema from '@metorial/json-schema';
import { JsonSchema } from '@metorial/json-schema';

declare class MetorialMcpClient {
    private readonly client;
    private constructor();
    static create(session: MetorialSDK.Session, opts: {
        host: string;
        deploymentId: string;
        clientName?: string;
        clientVersion?: string;
    }): Promise<MetorialMcpClient>;
    registerCapabilities(capabilities: ClientCapabilities): void;
    getServerCapabilities(): {
        [x: string]: unknown;
        experimental?: {
            [x: string]: unknown;
        } | undefined;
        logging?: {
            [x: string]: unknown;
        } | undefined;
        completions?: {
            [x: string]: unknown;
        } | undefined;
        prompts?: {
            [x: string]: unknown;
            listChanged?: boolean | undefined;
        } | undefined;
        resources?: {
            [x: string]: unknown;
            listChanged?: boolean | undefined;
            subscribe?: boolean | undefined;
        } | undefined;
        tools?: {
            [x: string]: unknown;
            listChanged?: boolean | undefined;
        } | undefined;
    };
    getServerVersion(): {
        [x: string]: unknown;
        name: string;
        version: string;
        title?: string | undefined;
    };
    getInstructions(): string | undefined;
    complete(params: CompleteRequest['params'], options?: RequestOptions): Promise<CompleteResult>;
    setLoggingLevel(level: LoggingLevel, options?: RequestOptions): Promise<object>;
    getPrompt(params: GetPromptRequest['params'], options?: RequestOptions): Promise<GetPromptResult>;
    listPrompts(params?: ListPromptsRequest['params'], options?: RequestOptions): Promise<ListPromptsResult>;
    listResources(params?: ListResourcesRequest['params'], options?: RequestOptions): Promise<ListResourcesResult>;
    listResourceTemplates(params?: ListResourceTemplatesRequest['params'], options?: RequestOptions): Promise<ListResourceTemplatesResult>;
    readResource(params: ReadResourceRequest['params'], options?: RequestOptions): Promise<ReadResourceResult>;
    callTool(params: CallToolRequest['params'], resultSchema?: typeof CallToolResultSchema | typeof CompatibilityCallToolResultSchema, options?: RequestOptions): Promise<any>;
    listTools(params?: ListToolsRequest['params'], options?: RequestOptions): Promise<ListToolsResult>;
    sendRootsListChanged(): Promise<void>;
    close(): Promise<void>;
}

type SmallServerDeployment = MetorialSDK.ServerCapabilities['mcpServers'][number]['serverDeployment'];
type Tool = Omit<MetorialSDK.ServerCapabilities['tools'][number], 'mcpServerId'>;
type ResourceTemplate = Omit<MetorialSDK.ServerCapabilities['resourceTemplates'][number], 'mcpServerId'>;
type Capability = {
    type: 'tool';
    tool: Tool;
    serverDeployment: SmallServerDeployment;
} | {
    type: 'resource-template';
    resourceTemplate: ResourceTemplate;
    serverDeployment: SmallServerDeployment;
};
declare class MetorialMcpTool {
    #private;
    private readonly session;
    private readonly action;
    private constructor();
    get name(): string;
    get id(): string;
    get description(): string | null;
    get parameters(): JsonSchema;
    call(args: any): Promise<any>;
    getParametersAs(as?: 'json-schema' | 'openapi-3.0.0' | 'openapi-3.1.0'): JsonSchema | _metorial_json_schema.OpenApiSchema;
    static fromTool(session: MetorialMcpSession, capability: Capability): MetorialMcpTool;
    static fromResourceTemplate(session: MetorialMcpSession, capability: Capability): MetorialMcpTool;
    static fromCapability(session: MetorialMcpSession, capability: Capability): MetorialMcpTool;
}

declare class MetorialMcpToolManager {
    #private;
    private readonly session;
    private constructor();
    static fromCapabilities(session: MetorialMcpSession, capabilities: Capability[]): Promise<MetorialMcpToolManager>;
    getTool(idOrName: string): MetorialMcpTool | undefined;
    getTools(): MetorialMcpTool[];
    callTool(idOrName: string, args: any): Promise<any>;
}

type MetorialMcpSessionInitServerDeployments = (DashboardInstanceSessionsCreateBody & {
    serverDeploymentIds?: never;
})['serverDeployments'];
type MetorialMcpSessionInit = {
    serverDeployments: MetorialMcpSessionInitServerDeployments;
    client?: {
        name?: string;
        version?: string;
    };
};
declare class MetorialMcpSession {
    #private;
    private readonly sdk;
    private readonly init;
    constructor(sdk: MetorialCoreSDK, init: MetorialMcpSessionInit);
    getSession(): Promise<MetorialSDK.Session>;
    getServerDeployments(): Promise<{
        object: "session.server_deployment#preview";
        id: string;
        name: string | null;
        oauthSessionId: string | null;
        description: string | null;
        metadata: Record<string, any>;
        createdAt: Date;
        updatedAt: Date;
        server: {
            object: "server#preview";
            id: string;
            name: string;
            description: string | null;
            type: "public" | "custom";
            createdAt: Date;
            updatedAt: Date;
        };
        connectionUrls: {
            sse: string;
            streamableHttp: string;
            websocket: string;
        };
    }[]>;
    getCapabilities(): Promise<Capability[]>;
    getToolManager(): Promise<MetorialMcpToolManager>;
    close(): Promise<void>;
    getClient(opts: {
        deploymentId: string;
    }): Promise<MetorialMcpClient>;
    private get mcpHost();
}

export { MetorialMcpClient, MetorialMcpSession, type MetorialMcpSessionInit, type MetorialMcpSessionInitServerDeployments, MetorialMcpTool, MetorialMcpToolManager };
